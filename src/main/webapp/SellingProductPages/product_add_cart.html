<!DOCTYPE html>
<html>

<head>
    <title>My Wishlist</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" rel="stylesheet">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/blackwoodalley-web/assets/css1/product_add_cart.css">
</head>

<body>
    <header>

        <!-- header starts -->
        <!--  communicate-us ends -->

        </div>

        </div>

        <div class="navigate">
            <div class="sub-logo">
                <img class="logo" src="../../assets/images/index_page/logo.png" alt="logo_for_webpage">
            </div>
            <div class="sub-navigate">
                <ul>
                    <li>
                        <a class="service" href="">About</a>
                        <div class="sub-service">

                            <ul>
                                <li>
                                    <a class="sub-service1" href="../../pages/about.html">About us</a>
                                </li>
                                <li>
                                    <a class="sub-service1" href="../../pages/restore/restore.html">How we restore</a>
                                </li>

                            </ul>
                        </div>

                    </li>
                    <li>
                        <a class="service" href="">Service</a>
                        <div class="sub-service">
                            <ul>
                                <li>
                                    <a class="sub-service1" href="../../pages/service/service2.html">Repair electronics</a>
                                </li>
                                <li>
                                    <a class="sub-service1" href="../../pages/service/service1.html">Repair furniture</a>
                                </li>
                                <li>
                                    <a class="sub-service1" href="../../pages/product/product.html">Buy</a>
                                </li>

                            </ul>

                        </div>
                    </li>
                    <li>
                        <a class="navi" href="../../pages/contact.html">Contact us</a>
                    </li>
                    <li>
                        <a class="navi" href="../../pages/track/track.html">Track request</a>
                    </li>
                    <li id="insert_login"></li>
                    <!-- <li><a class="navi" href="./pages/request.html">Restore</a></li> -->
                    <li id="admin">
                        <!-- <a class="service" href="">Admin</a>
                        <div class="sub-service">
                            <ul>
                                <li><a class="sub-service1" href="./pages/product_enter.html">product enter</a>
                                </li>
                                <li><a class="sub-service1" href="./pages/repairer_page.html">repairer page</a>
                                </li>

                            </ul>

                        </div> -->
                    </li>
                    <li id="insert_profile"></li>
                    <li id="login"></li>
                    <li>
                    <li class="icons">
                        <a href="../../pages/product/product_add_cart.html">
                            <div id="cart_count">0</div>
                            <i class="fa-solid fa-cart-shopping" id="shopping"></i>
                        </a>
                    </li>
                    <li class="icons">
                        <a href="../../pages/product/product_favourite.html">
                            <div id="fav_count">0</div>
                            <i class="fa-solid fa-heart" id="liked"></i>
                        </a>
                    </li>
                    <li class="icons">
                        <a href="../../pages/product/order_history.html">
                            <!-- <div id="fav_count">0</div> -->
                            <i class="fa-solid fa-clock-rotate-left" id="history_icon"
                            ></i>
                        </a>
                    </li>

                </ul>
            </div>

        </div>
        <!-- menu-bar ends -->

    </header>
    <div class="product_page">

        <!-- <div class="gallery_box">
            <a href="../product_detail.html" id="pic">
                <img class="gallery_imgs" src="">
               
            </a>
            <div class="side2">
                <h2 class="product_name">chair</h2>
                <p class="detail">This is dsfghjk fdghjkl fghjkl 200 years old</p>
                <div class="rating">
                </div>

            </div>

            <div class="add_cart_box">
                <p class="price">&#8377; 23,000</p>
            </div>
            <div class="add_cart_box">
                <h3 id="stock">stock In</h3>
            </div>

            <div class="add_cart_box">
                <button id="add_cart">Add to favourite</button>
            </div>

            <div class="add_cart_box">
                <i id="trash" class="fa-solid fa-trash"></i>
            </div> -->

        <!-- </div> -->
        
    </div>

    <p id="total_amount"></p>
    <p id="order_amount"></p>
 
    <button id="check_out">Check Out </button>
<script src="../javascript/product_add_cart.js">
	
	const wishlist_arr = JSON.parse(localStorage.getItem("wishlist"));
const user_detail = JSON.parse(localStorage.getItem("user_list"));
const product_information = JSON.parse(localStorage.getItem("product_detail"));

let output = "";
let order_count = 0;
let total = 0;
const last_email = localStorage.getItem("logged_in");
// console.log(last_email);

wishlist_arr.forEach((element) => {
  product_information.forEach((item) => {
    if (item.productid == element.productid) {
      // console.log("ppapa")
      if (element.status && element.wishlist_email == last_email) {
        order_count++;
        output += `<div class="gallery_box">
    <a href="../product_detail.html" id="pic">
        <img class="gallery_imgs" src="${element.pr_img_1}">
       
    </a>
    <div class="side2">
        <h2 class="product_name">${element.product_name}</h2>
        <div class="rating">
    
        </div>

    </div>


    <div class="add_cart_box">
        <p class="price">â‚¹ ${element.product_price}</p>
    </div>
    <div class="add_cart_box">
        <p id="stock">${element.highlights}</p>
    </div>

   

    <div class="add_cart_box">
        <p><i id="trash" onclick="delete_wishlist(${element.productid})" class="fa-solid fa-trash"></i></p>
    </div>
    
</div>`;

        total += Number(element.product_price);

        document.querySelector(".product_page").innerHTML = output;
      }
    }
  });
});


if(total==0){
  console.log(output,"nitthi")
  document.getElementById("total_amount").remove()
  document.getElementById("order_amount").remove()
  document.getElementById("check_out").remove()
  document.querySelector(".product_page").innerHTML = `<p id="when_empty">There is no product in the add to cart</p>`
}
// console.log(order_count);

// console.log(total)
const total_amount = document.getElementById("total_amount");
total_amount.innerHTML = `Total product price : ` + `  ` + ` ${total}`;
const order_amount = document.getElementById("order_amount");
order_amount.innerHTML = `Order price   :   ` + `  ` +`${total}`;

function delete_wishlist(id) {
  wishlist_arr.find((obj) => {
    if (obj.productid == id){
      obj.status = false;
      // console.log(obj.status)
      localStorage.setItem("wishlist", JSON.stringify(wishlist_arr));
    }
  });
}

user_detail.forEach((obj) => {
  if (last_email == obj.emailid) {
    obj.count = order_count;
    localStorage.setItem("user_list", JSON.stringify(user_detail));
    // console.log(user_detail)
  }
});

// function wishlist_details(selected) {

// let wishlist_img=document.querySelector(".gallery_imgs");
// // console.log(wishlist_img)
// wishlist_img.setAttribute("src", selected.pr_img_1)
// let wishlist_name=document.querySelector(".product_name");
// wishlist_name.innerHTML=selected["product_name"];
// let wishlist_details=document.querySelector(".detail");
// wishlist_details.innerHTML=selected["description"]

// let wishlist_rating=document.querySelector(".rating");
// wishlist_rating.innerHTML="xfdsdfsa";

// // href_link = "../product/product_detail.html?prod_id=" + item["productid"];

// let wishlist_price=document.querySelector(".price");
// wishlist_price.innerHTML=`${selected["product_price"]}`;

// let wishlist_stock=document.getElementById("stock");
// wishlist_stock.innerHTML="stock In";

// }

const checkOut = document.getElementById("check_out");
checkOut.addEventListener("click", () => {
  window.location.href = ` ../product/product_buynow.html?last_email=${last_email}`;
});

</script>
</body>

</html>